#importing libraries
import requests as r
from bs4 import BeautifulSoup as bs
import openpyxl as s
excel=s.Workbook()
sheet=excel.active
sheet.title='Top Rated Movies'
sheet.append(['RANK','MOVIE','YEAR','RATING'])

url="https://www.imdb.com/chart/top"
data=r.get(url)
soup=bs(data.text,'html.parser')
movies=soup.find('tbody',class_="lister-list").find_all('tr')
for movie in movies:
    name=movie.find('td',class_="titleColumn").a.text
    rank=movie.find('td',class_="titleColumn").get_text(strip=True).split('.')[0]
    year=movie.find('td',class_="titleColumn").span.text.strip('()')
    Rating=movie.find('td',class_="ratingColumn imdbRating").strong.text
    sheet.append([rank,name,year,Rating])
excel.save('IMDB MOVIE RATINGS.xlsx')